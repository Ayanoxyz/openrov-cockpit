<dom-module name="orov-telemetry-item">
<style>
.std {
  background-color: black;
  color: white;
  width: 100px;
  height: 40px;
  line-height: 40px;
  font-size: 2vw;
}
</style>
  <template>
    <label>{{telemetryItem}}</label>
  <div on-click="toggle">
  <link href="../grapp-graph-epoch/grapp-graph-epoch.html" rel="import">
    <grapp-graph-epoch id="timegraph" hidden="{{!enabled}}" type="time.line" axis="" width="100" height="40">
      <grapp-graph-epoch-series label="Time Series 1"
        data='[{"time":1370044800,"y":1},{"time":1370044801,"y":10}]'>
      </grapp-graph-epoch-series>
    </grapp-graph-epoch>
  <span id="instantvalue" hidden="{{enabled}}" class="std">{{telemetryItemValue}}</span>
</div>
  </template>

  <script>
    (function() {

      Polymer({
        is:'orov-telemetry-item',
        properties:{
          telemetryItem: {type:String, persisted: true},
          telemetryItemValue: {type:String, observer: 'telemetryItemValueChanged'},
          enabled: {type: Boolean, value: true}
        },
        behaviors: [namespace('behaviors').oROVStandard],
        registerEmitterHanlders: function(emitter){
          var self = this;
          emitter.on('status',function(status){
            self.logStatusData(status);
          });
        },
        telemetryItemValueChanged: function(newvalue,oldvalue){
          //should update graph
        },
        logStatusData: function (data) {
          var t = Object.keys(data)
          for (var i in t) {
            if (this.telemetryItem == t[i]){
              if (!Number.isNaN(data[t[i]])){
                if (this.$.timegraph.push !== undefined){
                  this.$.timegraph.push((new Date()).getTime()/1000, data[t[i]]);
                }
              }
              this.telemetryItemValue = data[t[i]];
            }
          }
        },
        toggle: function(){
          this.enabled = !this.enabled;
        }
      })
    })();
  </script>

</dom-module>
